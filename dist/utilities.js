define(["VSS/Controls/Notifications","VSS/Controls","VSS/Service","TFS/WorkItemTracking/RestClient","TFS/Core/RestClient"],function(e,t,r,n,o){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r=window.webpackJsonp;window.webpackJsonp=function(t,n,i){for(var a,c,s=0,u=[];s<t.length;s++)c=t[s],o[c]&&u.push(o[c][0]),o[c]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);for(r&&r(t,n,i);u.length;)u.shift()()};var n={},o={10:0,11:0};return t.e=function(e){function r(){c.onerror=c.onload=null,clearTimeout(s);var t=o[e];0!==t&&(t&&t[1](new Error("Loading chunk "+e+" failed.")),o[e]=void 0)}var n=o[e];if(0===n)return new Promise(function(e){e()});if(n)return n[2];var i=new Promise(function(t,r){n=o[e]=[t,r]});n[2]=i;var a=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.async=!0,c.timeout=12e4,t.nc&&c.setAttribute("nonce",t.nc),c.src=t.p+""+e+".js";var s=setTimeout(r,12e4);return c.onerror=c.onload=r,a.appendChild(c),i},t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t.oe=function(e){throw console.error(e),e},t(t.s=4)}([function(t,r){t.exports=e},function(e,t,r){var n,o;n=[r,t,r(2),r(0),r(5),r(3)],void 0!==(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.displayMessage=function(e,t){$("#message").html("");var o=r.create(n.MessageAreaControl,$("#message"),null);o.setMessage(e,t),this.messenger=o},e.prototype.closeMessage=function(){this.messenger.hideElement()},e}();t.MessageService=a;var c=function(){function e(){}return e.prototype.getWorkItems=function(e,t){var r=new Array,n=i.getCollectionClient(o.WorkItemTrackingHttpClient),a={query:e};return n.queryByWiql(a).then(function(e){if(!e.workItems)throw new Error("The query supplied does not produce any work item results.");return e.workItems.forEach(function(e){r.push(e.id)}),n.getWorkItems(r,t)})},e.prototype.getWorkItemHierarchy=function(e,t,r){var n=new Array,a=new Array,c=i.getCollectionClient(o.WorkItemTrackingHttpClient),s={query:e};return c.queryByWiql(s).then(function(e){if(!e.workItemRelations)throw new Error("The query supplied does not produce any work item relations.");return e.workItemRelations.forEach(function(e){var t={data:{id:e.target.id,name:"",parent:e.source?e.source.id:r,link:e.target.url}};n.push(t),a.push(e.target.id)}),c.getWorkItems(a,t).then(function(e){return e.forEach(function(e,t){n.forEach(function(t,r){if(t.data.id===e.id)return t.data.name=e.fields["System.Title"],void(t.data.workItemType=e.fields["System.WorkItemType"])})}),n})})},e.prototype.getWorkItemTypes=function(){return i.getCollectionClient(o.WorkItemTrackingHttpClient).getWorkItemTypes(VSS.getWebContext().project.name)},e}();t.QueryService=c}.apply(t,n))&&(e.exports=o)},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){var n,o;n=[r,t,r(1),r(0),r(7),r(3)],void 0!==(o=function(e,t,n,o,i,a){"use strict";function c(e){try{e()}catch(e){p.displayMessage(e,o.MessageAreaType.Error)}}function s(e){return a.getCollectionClient(i.CoreHttpClient).getProject(e,!0)}function u(e,t){var n={},o=new Array,i=JSON.parse(e);o[0]=["RequirementId","Title","Description","MappedItems"],i.forEach(function(e,t){o[t+1]=[e.RequirementId,e.Title,e.Description,e.MappedItems]});var a={s:{c:1e7,r:1e7},e:{c:0,r:0}};r.e(0).then(function(){var e=[r(12)];(function(e){for(var r=0;r!==o.length;++r)for(var i=0;i!==o[r].toString().length;++i){a.s.r>r&&(a.s.r=r),a.s.c>i&&(a.s.c=i),a.e.r<r&&(a.e.r=r),a.e.c<i&&(a.e.c=i);var c={v:o[r][i],t:"s"};if(null!=c.v){var s=XLSX.utils.encode_cell({c:i,r:r});"number"==typeof c.v?c.t="n":"boolean"==typeof c.v?c.t="b":c.v instanceof Date?(c.t="n",c.z=XLSX.SSF._table[14],c.v=l(c.v)):c.t="s",n[s]=c}}a.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(a));var u={SheetNames:[],Sheets:{}};u.SheetNames.push("Requirements"),u.Sheets.Requirements=n;var p=XLSX.write(u,t);return e(new Blob([function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!==e.length;++n)r[n]=255&e.charCodeAt(n);return t}(p)],{type:"application/octet-stream"}),VSS.getWebContext().project.name+".xlsx")}).apply(null,e)}).catch(r.oe)}Object.defineProperty(t,"__esModule",{value:!0});var l,p=new n.MessageService;t.executeBoundary=c,t.getProcessTemplate=s,t.exportToExcel=u}.apply(t,n))&&(e.exports=o)},function(e,t){e.exports=n},,function(e,t){e.exports=o}])});