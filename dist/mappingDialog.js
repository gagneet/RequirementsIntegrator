define(["VSS/Controls/Notifications","VSS/Controls","VSS/Service","TFS/WorkItemTracking/RestClient","VSS/Controls/Dialogs","VSS/Controls/Grids"],function(e,t,n,r,o,i){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(t,n){t.exports=e},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5),n(3)],void 0!==(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.displayMessage=function(e,t){$("#message").html("");var o=n.create(r.MessageAreaControl,$("#message"),null);o.setMessage(e,t),this.messenger=o},e.prototype.closeMessage=function(){this.messenger.hideElement()},e}();t.MessageService=s;var a=function(){function e(){}return e.prototype.getWorkItems=function(e,t){var n=new Array,r=i.getCollectionClient(o.WorkItemTrackingHttpClient),s={query:e};return r.queryByWiql(s).then(function(e){if(!e.workItems)throw new Error("The query supplied does not produce any work item results.");return e.workItems.forEach(function(e){n.push(e.id)}),r.getWorkItems(n,t)})},e.prototype.getWorkItemHierarchy=function(e,t,n){var r=new Array,s=new Array,a=i.getCollectionClient(o.WorkItemTrackingHttpClient),u={query:e};return a.queryByWiql(u).then(function(e){if(!e.workItemRelations)throw new Error("The query supplied does not produce any work item relations.");return e.workItemRelations.forEach(function(e){var t={data:{id:e.target.id,name:"",parent:e.source?e.source.id:n,link:e.target.url}};r.push(t),s.push(e.target.id)}),a.getWorkItems(s,t).then(function(e){return e.forEach(function(e,t){r.forEach(function(t,n){if(t.data.id===e.id)return t.data.name=e.fields["System.Title"],void(t.data.workItemType=e.fields["System.WorkItemType"])})}),r})})},e.prototype.getWorkItemTypes=function(){return i.getCollectionClient(o.WorkItemTrackingHttpClient).getWorkItemTypes(VSS.getWebContext().project.name)},e}();t.QueryService=a}.apply(t,r))&&(e.exports=o)},function(e,n){e.exports=t},function(e,t){e.exports=n},,function(e,t){e.exports=r},,,,,,,,function(e,t){e.exports=o},function(e,t){e.exports=i},,,function(e,t,n){var r,o,i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();r=[n,t,n(2),n(14),n(1),n(13),n(0)],void 0!==(o=function(e,t,n,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,c=function(e){function t(t){var n=e.call(this)||this,r=n;return r.context=t,r.messenger=new o.MessageService,$("#workItemType").on("change",r.getItems),n}return i(t,e),t.prototype.getItems=function(e){var t=new o.MessageService;$("#mappingContent").html("").hide(),(new o.QueryService).getWorkItems("select * from WorkItems where [System.WorkItemType] = '"+$("#workItemType").val()+"' AND [System.TeamProject] = '"+VSS.getWebContext().project.name+"'",["System.Title","System.WorkItemType"]).then(function(e){var t=$("#mappingContent"),o=new Array;if(0===e.length)throw"No work items found for the type selected.";e.forEach(function(e){var t={id:0,title:"",type:""};t.id=e.id,t.title=e.fields["System.Title"],t.type=e.fields["System.WorkItemType"],o.push(t)}),t.html(""),$("#message").html("");var i=n.create(r.Grid,t,{width:"100%",height:"200px",lastCellFillsRemainingContent:!0,openRowDetail:function(e){var t=i.getRowData(e);window.open(VSS.getWebContext().host.uri+"/"+VSS.getWebContext().project.name+"/_workitems#_a=edit&id="+t.id+"&fullScreen=true","_blank")},columns:[{text:"Select",width:50,index:"",getCellContents:function(e,t,n,r,o,s,a){var c=$("<input class='reqt-select' type='checkbox' />").val(i.getColumnValue(t,"id"));c.on("click",function(e){var t=e.target;t.checked?u.push(t.value):u=u.filter(function(e){return e!==t.value})});var l=$("<div class='grid-cell total'></div>");return l.width(o.width||100).append(c),l.append(c)}},{text:"ID",index:"id",width:35},{text:"Title",index:"title",width:275}],source:o})},function(e){var n="";n=e.message.startsWith("400")?"No work items found for this type.":e.message,t.displayMessage(n,a.MessageAreaType.Error)}),$("#mappingContent").show()},t.prototype.start=function(e){var t=this;t.requirementId=e,(new o.QueryService).getWorkItemTypes().then(function(e){$("#workItemType").html(""),e.filter(function(e){return null==e.name.match("Test")&&null==e.name.match("Shared")&&null==e.name.match("Feedback")&&null==e.name.match("Code Review")}).forEach(function(e){$("#workItemType").append($("<option />").text(e.name).val(e.name))}),$("#workItemTypeGroup").show()},function(e){t.messenger.displayMessage(e.message,a.MessageAreaType.Error)})},t.prototype.save=function(){return u.join(",")},t}(s.ModalDialog);t.MappingDialog=c,u=new Array,t.dlg=new c}.apply(t,r))&&(e.exports=o)}])});